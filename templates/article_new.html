{% extends 'layout.html' %}

{% block content %}
  <section>
    {% if flash_messages.login %} 
      <p>{{ flash_messages.login[0] }}</p>
    {% endif %}
    <div class="container">
      <form id="create">
        <input type="text" id="new_title" placeholder="Titre">
        <textarea id="new_body" placeholder="Corps"></textarea>
        <input type="submit" value="Valider">
      </form>
    </div>
  </section>

<script type="text/javascript">
$(document).ready(function() {

	$('form#create').submit(function(e){
		e.preventDefault();

		var new_title = $('#new_title').val(),
			new_body = $('#new_body').val(),

			url = "/articles/new",
			data = { title: new_title, body: new_body };
		
		app.POST(url, data)
			.done(function(res) {
				alert('Article créée.');
				window.location = '/articles';
			})
			.fail(function(res) {
				alert( "error" );
			});
	});
});
</script>
{% endblock %}